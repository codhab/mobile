
%p
  %h4#rg Comprovante de Renda e Carteira de Trabalho (de ambos, quando for o caso);
= simple_form_for @document, url: custom_custom_ticket_custom_documents_path(type: 'income', document_type_id: 7, anchor: 'rg', dependent_mirror_id: params[:dependent_mirror_id]) do |f|
  - equal = "= #{params[:dependent_mirror_id]}"
  - sql = "#{params[:dependent_mirror_id].present? ? equal : 'is null'}"
  - @ticket.documents.where(document_type_id: 7).where("dependent_mirror_id #{sql}").each_with_index do |document, index|
    .ui.segment{style: 'padding-top: 2px !important;padding-bottom: 1px !important'}
      - if %w(jpg jpeg gif png).include?(document.attachment.to_s.split('.')[-1])
        Arquivo #{index + 1}
        %div{style: 'width: 100%; height: 40px; overflow: hidden; position: relative;'}
          = link_to custom_custom_image_path(document), remote: true do
            = image_tag document.attachment, style: 'width: auto; position: absolute; top: 10%; left: 0; transform: translateX(-25%) translateY(-50%);'
      - else
        Arquivo #{index + 1}
        %br
        %br
        %b.text-center= link_to "Baixar arquivo", document.attachment_url, target: '_blank'
        %br
      %br
  = f.input :attachment, label: false, as: :file, input_html: { class: 'upload' }
%br
%br
- if params[:dependent_mirror_id].present?
  - if @ticket.documents.where(document_type_id: 6, dependent_mirror_id: params[:dependent_mirror_id]).count >= 1
    = link_to "Continuar atualização", custom_custom_ticket_custom_incomes_path(@ticket), class: 'ui button fluid green', style: 'font-size: 25px', data: { disable_with: 'Finalizando. Aguarde...'}
  - else
    %br
    %br
    .ui.label.red{style: 'text-align: justify'}
      %p Para realizar a finalização desta etapa, favor enviar ao menos um arquivo de cada categoria de documentaçãoe exigida.
- else
  - if @ticket.documents.where(document_type_id: 6).where('dependent_mirror_id is null').count >= 1
    = link_to "Continuar atualização", custom_custom_ticket_custom_incomes_path(@ticket), class: 'ui button fluid green', style: 'font-size: 25px', data: { disable_with: 'Finalizando. Aguarde...'}
